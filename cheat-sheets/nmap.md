# Nmap

## Targets

| Command                 | Result                   |
| ----------------------- | ------------------------ |
| nmap 10.0.0.1           | Scan a single IP         |
| nmap 10.0.0.1 10.0.0.2  | Scan specific IPs        |
| nmap 10.0.0.1-254       | Scan a range             |
| nmap scanme.nmap.org    | Scan a domain            |
| nmap 10.0.0.0/8         | Scan using CIDR notation |
| nmap -iL targets.txt    | Scan targets from a file |
| nmap -iR 25             | Scan 25 random hosts     |
| nmap --exclude 10.0.0.5 | Exclude listed hosts     |

## Techniques

| Command           | Result                |
| ----------------- | --------------------- |
| nmap 10.0.0.1 -sS | TCP SYN port scan     |
| nmap 10.0.0.1 -sT | TCP connect port scan |
| nmap 10.0.0.1 -sU | UDP port scan         |
| nmap 10.0.0.1 -sA | TCP ACK port scan     |
| nmap 10.0.0.1 -sW | TCP Window port scan  |
| nmap 10.0.0.1 -sM | TCP Maimon port scan  |

## Ports

| Command                | Result                            |
| ---------------------- | --------------------------------- |
| nmap -p 22 10.0.0.1    | Scan a single Port                |
| nmap -p 1-100 10.0.0.1 | Scan a range of ports             |
| nmap -F 10.0.0.1       | Scan 100 most common ports (Fast) |
| nmap -p- 10.0.0.1      | Scan all 65535 ports              |

## Service and OS Detection

| Command                                 | Result                            |
| --------------------------------------- | --------------------------------- |
| nmap -A 10.0.0.1                        | Detect OS and Services            |
| nmap -sV 10.0.0.1                       | Standard service detection        |
| nmap -sV --version-intensity 5 10.0.0.1 | More aggressive Service Detection |
| nmap -sV --version-intensity 0 10.0.0.1 | Lighter banner grabbing detection |

## Output

| Command                          | Result                            |
| -------------------------------- | --------------------------------- |
| nmap -oN outputfile.txt 10.0.0.1 | Save default output to file       |
| nmap -oX outputfile.xml 10.0.0.1 | Save results as XML               |
| nmap -oG outputfile.txt 10.0.0.1 | Save results in a format for grep |
| nmap -oA outputfile 10.0.0.1     | Save in all formats               |

## NSE Scripts

| Command                                             | Result                           |
| --------------------------------------------------- | -------------------------------- |
| nmap -sV -sC 10.0.0.1                               | Scan using default safe scripts  |
| nmap --script-help=ssl-heartbleed                   | Get help for a script            |
| nmap -sV -p 443 â€“script=ssl-heartbleed.nse 10.0.0.1 | Scan using a specific NSE script |
| nmap -sV --script=smb\* 10.0.0.1                    | Scan with a set of scripts       |

## Timing

| Command                        | Result                                                                    |
| ------------------------------ | ------------------------------------------------------------------------- |
| nmap -T0 10.0.0.1              | Very slow, used for IDS evasion                                           |
| nmap -T1 10.0.0.1              | Quite slow, used for IDS evasion                                          |
| nmap -T2 10.0.0.1              | Slows down to consume less bandwidth, runs \~10 times slower than default |
| nmap -T3 10.0.0.1              | Default, a dynamic timing model                                           |
| based on target responsiveness |                                                                           |
| nmap -T4 10.0.0.1              | Very slow, used for IDS evasion                                           |
| nmap -T5 10.0.0.1              | Very slow, used for IDS evasion                                           |
